/*
 * biquintic.cpp
 *
 *  Created on: May 9, 2018
 *      Author: dmarce1
 */

#include "biquintic.hpp"
#include <cmath>

constexpr real W[36][36] = { { 0.00013732910156250, -0.0011444091796875,
		0.0068664550781250, 0.0068664550781250, -0.0011444091796875,
		0.00013732910156250, -0.0011444091796875, 0.0095367431640625,
		-0.057220458984375, -0.057220458984375, 0.0095367431640625,
		-0.0011444091796875, 0.0068664550781250, -0.057220458984375,
		0.34332275390625, 0.34332275390625, -0.057220458984375,
		0.0068664550781250, 0.0068664550781250, -0.057220458984375,
		0.34332275390625, 0.34332275390625, -0.057220458984375,
		0.0068664550781250, -0.0011444091796875, 0.0095367431640625,
		-0.057220458984375, -0.057220458984375, 0.0095367431640625,
		-0.0011444091796875, 0.00013732910156250, -0.0011444091796875,
		0.0068664550781250, 0.0068664550781250, -0.0011444091796875,
		0.00013732910156250 }, { -0.000054931640625000, 0.00045776367187500,
		-0.0027465820312500, -0.0027465820312500, 0.00045776367187500,
		-0.000054931640625000, 0.00076293945312500, -0.0063578287760417,
		0.038146972656250, 0.038146972656250, -0.0063578287760417,
		0.00076293945312500, -0.013732910156250, 0.11444091796875,
		-0.68664550781250, -0.68664550781250, 0.11444091796875,
		-0.013732910156250, 0.013732910156250, -0.11444091796875,
		0.68664550781250, 0.68664550781250, -0.11444091796875,
		0.013732910156250, -0.00076293945312500, 0.0063578287760417,
		-0.038146972656250, -0.038146972656250, 0.0063578287760417,
		-0.00076293945312500, 0.000054931640625000, -0.00045776367187500,
		0.0027465820312500, 0.0027465820312500, -0.00045776367187500,
		0.000054931640625000 }, { -0.00061035156250000, 0.0050862630208333,
		-0.030517578125000, -0.030517578125000, 0.0050862630208333,
		-0.00061035156250000, 0.0047607421875000, -0.039672851562500,
		0.23803710937500, 0.23803710937500, -0.039672851562500,
		0.0047607421875000, -0.0041503906250000, 0.034586588541667,
		-0.20751953125000, -0.20751953125000, 0.034586588541667,
		-0.0041503906250000, -0.0041503906250000, 0.034586588541667,
		-0.20751953125000, -0.20751953125000, 0.034586588541667,
		-0.0041503906250000, 0.0047607421875000, -0.039672851562500,
		0.23803710937500, 0.23803710937500, -0.039672851562500,
		0.0047607421875000, -0.00061035156250000, 0.0050862630208333,
		-0.030517578125000, -0.030517578125000, 0.0050862630208333,
		-0.00061035156250000 }, { 0.00024414062500000, -0.0020345052083333,
		0.012207031250000, 0.012207031250000, -0.0020345052083333,
		0.00024414062500000, -0.0031738281250000, 0.026448567708333,
		-0.15869140625000, -0.15869140625000, 0.026448567708333,
		-0.0031738281250000, 0.0083007812500000, -0.069173177083333,
		0.41503906250000, 0.41503906250000, -0.069173177083333,
		0.0083007812500000, -0.0083007812500000, 0.069173177083333,
		-0.41503906250000, -0.41503906250000, 0.069173177083333,
		-0.0083007812500000, 0.0031738281250000, -0.026448567708333,
		0.15869140625000, 0.15869140625000, -0.026448567708333,
		0.0031738281250000, -0.00024414062500000, 0.0020345052083333,
		-0.012207031250000, -0.012207031250000, 0.0020345052083333,
		-0.00024414062500000 }, { 0.00024414062500000, -0.0020345052083333,
		0.012207031250000, 0.012207031250000, -0.0020345052083333,
		0.00024414062500000, -0.00073242187500000, 0.0061035156250000,
		-0.036621093750000, -0.036621093750000, 0.0061035156250000,
		-0.00073242187500000, 0.00048828125000000, -0.0040690104166667,
		0.024414062500000, 0.024414062500000, -0.0040690104166667,
		0.00048828125000000, 0.00048828125000000, -0.0040690104166667,
		0.024414062500000, 0.024414062500000, -0.0040690104166667,
		0.00048828125000000, -0.00073242187500000, 0.0061035156250000,
		-0.036621093750000, -0.036621093750000, 0.0061035156250000,
		-0.00073242187500000, 0.00024414062500000, -0.0020345052083333,
		0.012207031250000, 0.012207031250000, -0.0020345052083333,
		0.00024414062500000 }, { -0.000097656250000000, 0.00081380208333333,
		-0.0048828125000000, -0.0048828125000000, 0.00081380208333333,
		-0.000097656250000000, 0.00048828125000000, -0.0040690104166667,
		0.024414062500000, 0.024414062500000, -0.0040690104166667,
		0.00048828125000000, -0.00097656250000000, 0.0081380208333333,
		-0.048828125000000, -0.048828125000000, 0.0081380208333333,
		-0.00097656250000000, 0.00097656250000000, -0.0081380208333333,
		0.048828125000000, 0.048828125000000, -0.0081380208333333,
		0.00097656250000000, -0.00048828125000000, 0.0040690104166667,
		-0.024414062500000, -0.024414062500000, 0.0040690104166667,
		-0.00048828125000000, 0.000097656250000000, -0.00081380208333333,
		0.0048828125000000, 0.0048828125000000, -0.00081380208333333,
		0.000097656250000000 }, { -0.000054931640625000, 0.00076293945312500,
		-0.013732910156250, 0.013732910156250, -0.00076293945312500,
		0.000054931640625000, 0.00045776367187500, -0.0063578287760417,
		0.11444091796875, -0.11444091796875, 0.0063578287760417,
		-0.00045776367187500, -0.0027465820312500, 0.038146972656250,
		-0.68664550781250, 0.68664550781250, -0.038146972656250,
		0.0027465820312500, -0.0027465820312500, 0.038146972656250,
		-0.68664550781250, 0.68664550781250, -0.038146972656250,
		0.0027465820312500, 0.00045776367187500, -0.0063578287760417,
		0.11444091796875, -0.11444091796875, 0.0063578287760417,
		-0.00045776367187500, -0.000054931640625000, 0.00076293945312500,
		-0.013732910156250, 0.013732910156250, -0.00076293945312500,
		0.000054931640625000 }, { 0.000021972656250000, -0.00030517578125000,
		0.0054931640625000, -0.0054931640625000, 0.00030517578125000,
		-0.000021972656250000, -0.00030517578125000, 0.0042385525173611,
		-0.076293945312500, 0.076293945312500, -0.0042385525173611,
		0.00030517578125000, 0.0054931640625000, -0.076293945312500,
		1.3732910156250, -1.3732910156250, 0.076293945312500,
		-0.0054931640625000, -0.0054931640625000, 0.076293945312500,
		-1.3732910156250, 1.3732910156250, -0.076293945312500,
		0.0054931640625000, 0.00030517578125000, -0.0042385525173611,
		0.076293945312500, -0.076293945312500, 0.0042385525173611,
		-0.00030517578125000, -0.000021972656250000, 0.00030517578125000,
		-0.0054931640625000, 0.0054931640625000, -0.00030517578125000,
		0.000021972656250000 }, { 0.00024414062500000, -0.0033908420138889,
		0.061035156250000, -0.061035156250000, 0.0033908420138889,
		-0.00024414062500000, -0.0019042968750000, 0.026448567708333,
		-0.47607421875000, 0.47607421875000, -0.026448567708333,
		0.0019042968750000, 0.0016601562500000, -0.023057725694444,
		0.41503906250000, -0.41503906250000, 0.023057725694444,
		-0.0016601562500000, 0.0016601562500000, -0.023057725694444,
		0.41503906250000, -0.41503906250000, 0.023057725694444,
		-0.0016601562500000, -0.0019042968750000, 0.026448567708333,
		-0.47607421875000, 0.47607421875000, -0.026448567708333,
		0.0019042968750000, 0.00024414062500000, -0.0033908420138889,
		0.061035156250000, -0.061035156250000, 0.0033908420138889,
		-0.00024414062500000 }, { -0.000097656250000000, 0.0013563368055556,
		-0.024414062500000, 0.024414062500000, -0.0013563368055556,
		0.000097656250000000, 0.0012695312500000, -0.017632378472222,
		0.31738281250000, -0.31738281250000, 0.017632378472222,
		-0.0012695312500000, -0.0033203125000000, 0.046115451388889,
		-0.83007812500000, 0.83007812500000, -0.046115451388889,
		0.0033203125000000, 0.0033203125000000, -0.046115451388889,
		0.83007812500000, -0.83007812500000, 0.046115451388889,
		-0.0033203125000000, -0.0012695312500000, 0.017632378472222,
		-0.31738281250000, 0.31738281250000, -0.017632378472222,
		0.0012695312500000, 0.000097656250000000, -0.0013563368055556,
		0.024414062500000, -0.024414062500000, 0.0013563368055556,
		-0.000097656250000000 }, { -0.000097656250000000, 0.0013563368055556,
		-0.024414062500000, 0.024414062500000, -0.0013563368055556,
		0.000097656250000000, 0.00029296875000000, -0.0040690104166667,
		0.073242187500000, -0.073242187500000, 0.0040690104166667,
		-0.00029296875000000, -0.00019531250000000, 0.0027126736111111,
		-0.048828125000000, 0.048828125000000, -0.0027126736111111,
		0.00019531250000000, -0.00019531250000000, 0.0027126736111111,
		-0.048828125000000, 0.048828125000000, -0.0027126736111111,
		0.00019531250000000, 0.00029296875000000, -0.0040690104166667,
		0.073242187500000, -0.073242187500000, 0.0040690104166667,
		-0.00029296875000000, -0.000097656250000000, 0.0013563368055556,
		-0.024414062500000, 0.024414062500000, -0.0013563368055556,
		0.000097656250000000 }, { 0.000039062500000000, -0.00054253472222222,
		0.0097656250000000, -0.0097656250000000, 0.00054253472222222,
		-0.000039062500000000, -0.00019531250000000, 0.0027126736111111,
		-0.048828125000000, 0.048828125000000, -0.0027126736111111,
		0.00019531250000000, 0.00039062500000000, -0.0054253472222222,
		0.097656250000000, -0.097656250000000, 0.0054253472222222,
		-0.00039062500000000, -0.00039062500000000, 0.0054253472222222,
		-0.097656250000000, 0.097656250000000, -0.0054253472222222,
		0.00039062500000000, 0.00019531250000000, -0.0027126736111111,
		0.048828125000000, -0.048828125000000, 0.0027126736111111,
		-0.00019531250000000, -0.000039062500000000, 0.00054253472222222,
		-0.0097656250000000, 0.0097656250000000, -0.00054253472222222,
		0.000039062500000000 }, { -0.00061035156250000, 0.0047607421875000,
		-0.0041503906250000, -0.0041503906250000, 0.0047607421875000,
		-0.00061035156250000, 0.0050862630208333, -0.039672851562500,
		0.034586588541667, 0.034586588541667, -0.039672851562500,
		0.0050862630208333, -0.030517578125000, 0.23803710937500,
		-0.20751953125000, -0.20751953125000, 0.23803710937500,
		-0.030517578125000, -0.030517578125000, 0.23803710937500,
		-0.20751953125000, -0.20751953125000, 0.23803710937500,
		-0.030517578125000, 0.0050862630208333, -0.039672851562500,
		0.034586588541667, 0.034586588541667, -0.039672851562500,
		0.0050862630208333, -0.00061035156250000, 0.0047607421875000,
		-0.0041503906250000, -0.0041503906250000, 0.0047607421875000,
		-0.00061035156250000 }, { 0.00024414062500000, -0.0019042968750000,
		0.0016601562500000, 0.0016601562500000, -0.0019042968750000,
		0.00024414062500000, -0.0033908420138889, 0.026448567708333,
		-0.023057725694444, -0.023057725694444, 0.026448567708333,
		-0.0033908420138889, 0.061035156250000, -0.47607421875000,
		0.41503906250000, 0.41503906250000, -0.47607421875000,
		0.061035156250000, -0.061035156250000, 0.47607421875000,
		-0.41503906250000, -0.41503906250000, 0.47607421875000,
		-0.061035156250000, 0.0033908420138889, -0.026448567708333,
		0.023057725694444, 0.023057725694444, -0.026448567708333,
		0.0033908420138889, -0.00024414062500000, 0.0019042968750000,
		-0.0016601562500000, -0.0016601562500000, 0.0019042968750000,
		-0.00024414062500000 }, { 0.0027126736111111, -0.021158854166667,
		0.018446180555556, 0.018446180555556, -0.021158854166667,
		0.0027126736111111, -0.021158854166667, 0.16503906250000,
		-0.14388020833333, -0.14388020833333, 0.16503906250000,
		-0.021158854166667, 0.018446180555556, -0.14388020833333,
		0.12543402777778, 0.12543402777778, -0.14388020833333,
		0.018446180555556, 0.018446180555556, -0.14388020833333,
		0.12543402777778, 0.12543402777778, -0.14388020833333,
		0.018446180555556, -0.021158854166667, 0.16503906250000,
		-0.14388020833333, -0.14388020833333, 0.16503906250000,
		-0.021158854166667, 0.0027126736111111, -0.021158854166667,
		0.018446180555556, 0.018446180555556, -0.021158854166667,
		0.0027126736111111 }, { -0.0010850694444444, 0.0084635416666667,
		-0.0073784722222222, -0.0073784722222222, 0.0084635416666667,
		-0.0010850694444444, 0.014105902777778, -0.11002604166667,
		0.095920138888889, 0.095920138888889, -0.11002604166667,
		0.014105902777778, -0.036892361111111, 0.28776041666667,
		-0.25086805555556, -0.25086805555556, 0.28776041666667,
		-0.036892361111111, 0.036892361111111, -0.28776041666667,
		0.25086805555556, 0.25086805555556, -0.28776041666667,
		0.036892361111111, -0.014105902777778, 0.11002604166667,
		-0.095920138888889, -0.095920138888889, 0.11002604166667,
		-0.014105902777778, 0.0010850694444444, -0.0084635416666667,
		0.0073784722222222, 0.0073784722222222, -0.0084635416666667,
		0.0010850694444444 }, { -0.0010850694444444, 0.0084635416666667,
		-0.0073784722222222, -0.0073784722222222, 0.0084635416666667,
		-0.0010850694444444, 0.0032552083333333, -0.025390625000000,
		0.022135416666667, 0.022135416666667, -0.025390625000000,
		0.0032552083333333, -0.0021701388888889, 0.016927083333333,
		-0.014756944444444, -0.014756944444444, 0.016927083333333,
		-0.0021701388888889, -0.0021701388888889, 0.016927083333333,
		-0.014756944444444, -0.014756944444444, 0.016927083333333,
		-0.0021701388888889, 0.0032552083333333, -0.025390625000000,
		0.022135416666667, 0.022135416666667, -0.025390625000000,
		0.0032552083333333, -0.0010850694444444, 0.0084635416666667,
		-0.0073784722222222, -0.0073784722222222, 0.0084635416666667,
		-0.0010850694444444 }, { 0.00043402777777778, -0.0033854166666667,
		0.0029513888888889, 0.0029513888888889, -0.0033854166666667,
		0.00043402777777778, -0.0021701388888889, 0.016927083333333,
		-0.014756944444444, -0.014756944444444, 0.016927083333333,
		-0.0021701388888889, 0.0043402777777778, -0.033854166666667,
		0.029513888888889, 0.029513888888889, -0.033854166666667,
		0.0043402777777778, -0.0043402777777778, 0.033854166666667,
		-0.029513888888889, -0.029513888888889, 0.033854166666667,
		-0.0043402777777778, 0.0021701388888889, -0.016927083333333,
		0.014756944444444, 0.014756944444444, -0.016927083333333,
		0.0021701388888889, -0.00043402777777778, 0.0033854166666667,
		-0.0029513888888889, -0.0029513888888889, 0.0033854166666667,
		-0.00043402777777778 }, { 0.00024414062500000, -0.0031738281250000,
		0.0083007812500000, -0.0083007812500000, 0.0031738281250000,
		-0.00024414062500000, -0.0020345052083333, 0.026448567708333,
		-0.069173177083333, 0.069173177083333, -0.026448567708333,
		0.0020345052083333, 0.012207031250000, -0.15869140625000,
		0.41503906250000, -0.41503906250000, 0.15869140625000,
		-0.012207031250000, 0.012207031250000, -0.15869140625000,
		0.41503906250000, -0.41503906250000, 0.15869140625000,
		-0.012207031250000, -0.0020345052083333, 0.026448567708333,
		-0.069173177083333, 0.069173177083333, -0.026448567708333,
		0.0020345052083333, 0.00024414062500000, -0.0031738281250000,
		0.0083007812500000, -0.0083007812500000, 0.0031738281250000,
		-0.00024414062500000 }, { -0.000097656250000000, 0.0012695312500000,
		-0.0033203125000000, 0.0033203125000000, -0.0012695312500000,
		0.000097656250000000, 0.0013563368055556, -0.017632378472222,
		0.046115451388889, -0.046115451388889, 0.017632378472222,
		-0.0013563368055556, -0.024414062500000, 0.31738281250000,
		-0.83007812500000, 0.83007812500000, -0.31738281250000,
		0.024414062500000, 0.024414062500000, -0.31738281250000,
		0.83007812500000, -0.83007812500000, 0.31738281250000,
		-0.024414062500000, -0.0013563368055556, 0.017632378472222,
		-0.046115451388889, 0.046115451388889, -0.017632378472222,
		0.0013563368055556, 0.000097656250000000, -0.0012695312500000,
		0.0033203125000000, -0.0033203125000000, 0.0012695312500000,
		-0.000097656250000000 }, { -0.0010850694444444, 0.014105902777778,
		-0.036892361111111, 0.036892361111111, -0.014105902777778,
		0.0010850694444444, 0.0084635416666667, -0.11002604166667,
		0.28776041666667, -0.28776041666667, 0.11002604166667,
		-0.0084635416666667, -0.0073784722222222, 0.095920138888889,
		-0.25086805555556, 0.25086805555556, -0.095920138888889,
		0.0073784722222222, -0.0073784722222222, 0.095920138888889,
		-0.25086805555556, 0.25086805555556, -0.095920138888889,
		0.0073784722222222, 0.0084635416666667, -0.11002604166667,
		0.28776041666667, -0.28776041666667, 0.11002604166667,
		-0.0084635416666667, -0.0010850694444444, 0.014105902777778,
		-0.036892361111111, 0.036892361111111, -0.014105902777778,
		0.0010850694444444 }, { 0.00043402777777778, -0.0056423611111111,
		0.014756944444444, -0.014756944444444, 0.0056423611111111,
		-0.00043402777777778, -0.0056423611111111, 0.073350694444444,
		-0.19184027777778, 0.19184027777778, -0.073350694444444,
		0.0056423611111111, 0.014756944444444, -0.19184027777778,
		0.50173611111111, -0.50173611111111, 0.19184027777778,
		-0.014756944444444, -0.014756944444444, 0.19184027777778,
		-0.50173611111111, 0.50173611111111, -0.19184027777778,
		0.014756944444444, 0.0056423611111111, -0.073350694444444,
		0.19184027777778, -0.19184027777778, 0.073350694444444,
		-0.0056423611111111, -0.00043402777777778, 0.0056423611111111,
		-0.014756944444444, 0.014756944444444, -0.0056423611111111,
		0.00043402777777778 }, { 0.00043402777777778, -0.0056423611111111,
		0.014756944444444, -0.014756944444444, 0.0056423611111111,
		-0.00043402777777778, -0.0013020833333333, 0.016927083333333,
		-0.044270833333333, 0.044270833333333, -0.016927083333333,
		0.0013020833333333, 0.00086805555555556, -0.011284722222222,
		0.029513888888889, -0.029513888888889, 0.011284722222222,
		-0.00086805555555556, 0.00086805555555556, -0.011284722222222,
		0.029513888888889, -0.029513888888889, 0.011284722222222,
		-0.00086805555555556, -0.0013020833333333, 0.016927083333333,
		-0.044270833333333, 0.044270833333333, -0.016927083333333,
		0.0013020833333333, 0.00043402777777778, -0.0056423611111111,
		0.014756944444444, -0.014756944444444, 0.0056423611111111,
		-0.00043402777777778 }, { -0.00017361111111111, 0.0022569444444444,
		-0.0059027777777778, 0.0059027777777778, -0.0022569444444444,
		0.00017361111111111, 0.00086805555555556, -0.011284722222222,
		0.029513888888889, -0.029513888888889, 0.011284722222222,
		-0.00086805555555556, -0.0017361111111111, 0.022569444444444,
		-0.059027777777778, 0.059027777777778, -0.022569444444444,
		0.0017361111111111, 0.0017361111111111, -0.022569444444444,
		0.059027777777778, -0.059027777777778, 0.022569444444444,
		-0.0017361111111111, -0.00086805555555556, 0.011284722222222,
		-0.029513888888889, 0.029513888888889, -0.011284722222222,
		0.00086805555555556, 0.00017361111111111, -0.0022569444444444,
		0.0059027777777778, -0.0059027777777778, 0.0022569444444444,
		-0.00017361111111111 }, { 0.00024414062500000, -0.00073242187500000,
		0.00048828125000000, 0.00048828125000000, -0.00073242187500000,
		0.00024414062500000, -0.0020345052083333, 0.0061035156250000,
		-0.0040690104166667, -0.0040690104166667, 0.0061035156250000,
		-0.0020345052083333, 0.012207031250000, -0.036621093750000,
		0.024414062500000, 0.024414062500000, -0.036621093750000,
		0.012207031250000, 0.012207031250000, -0.036621093750000,
		0.024414062500000, 0.024414062500000, -0.036621093750000,
		0.012207031250000, -0.0020345052083333, 0.0061035156250000,
		-0.0040690104166667, -0.0040690104166667, 0.0061035156250000,
		-0.0020345052083333, 0.00024414062500000, -0.00073242187500000,
		0.00048828125000000, 0.00048828125000000, -0.00073242187500000,
		0.00024414062500000 }, { -0.000097656250000000, 0.00029296875000000,
		-0.00019531250000000, -0.00019531250000000, 0.00029296875000000,
		-0.000097656250000000, 0.0013563368055556, -0.0040690104166667,
		0.0027126736111111, 0.0027126736111111, -0.0040690104166667,
		0.0013563368055556, -0.024414062500000, 0.073242187500000,
		-0.048828125000000, -0.048828125000000, 0.073242187500000,
		-0.024414062500000, 0.024414062500000, -0.073242187500000,
		0.048828125000000, 0.048828125000000, -0.073242187500000,
		0.024414062500000, -0.0013563368055556, 0.0040690104166667,
		-0.0027126736111111, -0.0027126736111111, 0.0040690104166667,
		-0.0013563368055556, 0.000097656250000000, -0.00029296875000000,
		0.00019531250000000, 0.00019531250000000, -0.00029296875000000,
		0.000097656250000000 }, { -0.0010850694444444, 0.0032552083333333,
		-0.0021701388888889, -0.0021701388888889, 0.0032552083333333,
		-0.0010850694444444, 0.0084635416666667, -0.025390625000000,
		0.016927083333333, 0.016927083333333, -0.025390625000000,
		0.0084635416666667, -0.0073784722222222, 0.022135416666667,
		-0.014756944444444, -0.014756944444444, 0.022135416666667,
		-0.0073784722222222, -0.0073784722222222, 0.022135416666667,
		-0.014756944444444, -0.014756944444444, 0.022135416666667,
		-0.0073784722222222, 0.0084635416666667, -0.025390625000000,
		0.016927083333333, 0.016927083333333, -0.025390625000000,
		0.0084635416666667, -0.0010850694444444, 0.0032552083333333,
		-0.0021701388888889, -0.0021701388888889, 0.0032552083333333,
		-0.0010850694444444 }, { 0.00043402777777778, -0.0013020833333333,
		0.00086805555555556, 0.00086805555555556, -0.0013020833333333,
		0.00043402777777778, -0.0056423611111111, 0.016927083333333,
		-0.011284722222222, -0.011284722222222, 0.016927083333333,
		-0.0056423611111111, 0.014756944444444, -0.044270833333333,
		0.029513888888889, 0.029513888888889, -0.044270833333333,
		0.014756944444444, -0.014756944444444, 0.044270833333333,
		-0.029513888888889, -0.029513888888889, 0.044270833333333,
		-0.014756944444444, 0.0056423611111111, -0.016927083333333,
		0.011284722222222, 0.011284722222222, -0.016927083333333,
		0.0056423611111111, -0.00043402777777778, 0.0013020833333333,
		-0.00086805555555556, -0.00086805555555556, 0.0013020833333333,
		-0.00043402777777778 }, { 0.00043402777777778, -0.0013020833333333,
		0.00086805555555556, 0.00086805555555556, -0.0013020833333333,
		0.00043402777777778, -0.0013020833333333, 0.0039062500000000,
		-0.0026041666666667, -0.0026041666666667, 0.0039062500000000,
		-0.0013020833333333, 0.00086805555555556, -0.0026041666666667,
		0.0017361111111111, 0.0017361111111111, -0.0026041666666667,
		0.00086805555555556, 0.00086805555555556, -0.0026041666666667,
		0.0017361111111111, 0.0017361111111111, -0.0026041666666667,
		0.00086805555555556, -0.0013020833333333, 0.0039062500000000,
		-0.0026041666666667, -0.0026041666666667, 0.0039062500000000,
		-0.0013020833333333, 0.00043402777777778, -0.0013020833333333,
		0.00086805555555556, 0.00086805555555556, -0.0013020833333333,
		0.00043402777777778 }, { -0.00017361111111111, 0.00052083333333333,
		-0.00034722222222222, -0.00034722222222222, 0.00052083333333333,
		-0.00017361111111111, 0.00086805555555556, -0.0026041666666667,
		0.0017361111111111, 0.0017361111111111, -0.0026041666666667,
		0.00086805555555556, -0.0017361111111111, 0.0052083333333333,
		-0.0034722222222222, -0.0034722222222222, 0.0052083333333333,
		-0.0017361111111111, 0.0017361111111111, -0.0052083333333333,
		0.0034722222222222, 0.0034722222222222, -0.0052083333333333,
		0.0017361111111111, -0.00086805555555556, 0.0026041666666667,
		-0.0017361111111111, -0.0017361111111111, 0.0026041666666667,
		-0.00086805555555556, 0.00017361111111111, -0.00052083333333333,
		0.00034722222222222, 0.00034722222222222, -0.00052083333333333,
		0.00017361111111111 }, { -0.000097656250000000, 0.00048828125000000,
		-0.00097656250000000, 0.00097656250000000, -0.00048828125000000,
		0.000097656250000000, 0.00081380208333333, -0.0040690104166667,
		0.0081380208333333, -0.0081380208333333, 0.0040690104166667,
		-0.00081380208333333, -0.0048828125000000, 0.024414062500000,
		-0.048828125000000, 0.048828125000000, -0.024414062500000,
		0.0048828125000000, -0.0048828125000000, 0.024414062500000,
		-0.048828125000000, 0.048828125000000, -0.024414062500000,
		0.0048828125000000, 0.00081380208333333, -0.0040690104166667,
		0.0081380208333333, -0.0081380208333333, 0.0040690104166667,
		-0.00081380208333333, -0.000097656250000000, 0.00048828125000000,
		-0.00097656250000000, 0.00097656250000000, -0.00048828125000000,
		0.000097656250000000 }, { 0.000039062500000000, -0.00019531250000000,
		0.00039062500000000, -0.00039062500000000, 0.00019531250000000,
		-0.000039062500000000, -0.00054253472222222, 0.0027126736111111,
		-0.0054253472222222, 0.0054253472222222, -0.0027126736111111,
		0.00054253472222222, 0.0097656250000000, -0.048828125000000,
		0.097656250000000, -0.097656250000000, 0.048828125000000,
		-0.0097656250000000, -0.0097656250000000, 0.048828125000000,
		-0.097656250000000, 0.097656250000000, -0.048828125000000,
		0.0097656250000000, 0.00054253472222222, -0.0027126736111111,
		0.0054253472222222, -0.0054253472222222, 0.0027126736111111,
		-0.00054253472222222, -0.000039062500000000, 0.00019531250000000,
		-0.00039062500000000, 0.00039062500000000, -0.00019531250000000,
		0.000039062500000000 }, { 0.00043402777777778, -0.0021701388888889,
		0.0043402777777778, -0.0043402777777778, 0.0021701388888889,
		-0.00043402777777778, -0.0033854166666667, 0.016927083333333,
		-0.033854166666667, 0.033854166666667, -0.016927083333333,
		0.0033854166666667, 0.0029513888888889, -0.014756944444444,
		0.029513888888889, -0.029513888888889, 0.014756944444444,
		-0.0029513888888889, 0.0029513888888889, -0.014756944444444,
		0.029513888888889, -0.029513888888889, 0.014756944444444,
		-0.0029513888888889, -0.0033854166666667, 0.016927083333333,
		-0.033854166666667, 0.033854166666667, -0.016927083333333,
		0.0033854166666667, 0.00043402777777778, -0.0021701388888889,
		0.0043402777777778, -0.0043402777777778, 0.0021701388888889,
		-0.00043402777777778 }, { -0.00017361111111111, 0.00086805555555556,
		-0.0017361111111111, 0.0017361111111111, -0.00086805555555556,
		0.00017361111111111, 0.0022569444444444, -0.011284722222222,
		0.022569444444444, -0.022569444444444, 0.011284722222222,
		-0.0022569444444444, -0.0059027777777778, 0.029513888888889,
		-0.059027777777778, 0.059027777777778, -0.029513888888889,
		0.0059027777777778, 0.0059027777777778, -0.029513888888889,
		0.059027777777778, -0.059027777777778, 0.029513888888889,
		-0.0059027777777778, -0.0022569444444444, 0.011284722222222,
		-0.022569444444444, 0.022569444444444, -0.011284722222222,
		0.0022569444444444, 0.00017361111111111, -0.00086805555555556,
		0.0017361111111111, -0.0017361111111111, 0.00086805555555556,
		-0.00017361111111111 }, { -0.00017361111111111, 0.00086805555555556,
		-0.0017361111111111, 0.0017361111111111, -0.00086805555555556,
		0.00017361111111111, 0.00052083333333333, -0.0026041666666667,
		0.0052083333333333, -0.0052083333333333, 0.0026041666666667,
		-0.00052083333333333, -0.00034722222222222, 0.0017361111111111,
		-0.0034722222222222, 0.0034722222222222, -0.0017361111111111,
		0.00034722222222222, -0.00034722222222222, 0.0017361111111111,
		-0.0034722222222222, 0.0034722222222222, -0.0017361111111111,
		0.00034722222222222, 0.00052083333333333, -0.0026041666666667,
		0.0052083333333333, -0.0052083333333333, 0.0026041666666667,
		-0.00052083333333333, -0.00017361111111111, 0.00086805555555556,
		-0.0017361111111111, 0.0017361111111111, -0.00086805555555556,
		0.00017361111111111 }, { 0.000069444444444444, -0.00034722222222222,
		0.00069444444444444, -0.00069444444444444, 0.00034722222222222,
		-0.000069444444444444, -0.00034722222222222, 0.0017361111111111,
		-0.0034722222222222, 0.0034722222222222, -0.0017361111111111,
		0.00034722222222222, 0.00069444444444444, -0.0034722222222222,
		0.0069444444444444, -0.0069444444444444, 0.0034722222222222,
		-0.00069444444444444, -0.00069444444444444, 0.0034722222222222,
		-0.0069444444444444, 0.0069444444444444, -0.0034722222222222,
		0.00069444444444444, 0.00034722222222222, -0.0017361111111111,
		0.0034722222222222, -0.0034722222222222, 0.0017361111111111,
		-0.00034722222222222, -0.000069444444444444, 0.00034722222222222,
		-0.00069444444444444, 0.00069444444444444, -0.00034722222222222,
		0.000069444444444444 } };

static real rand1() {
	return (std::rand() + real(0.5)) / (real(RAND_MAX) + real(1));
}

biquintic_table::biquintic_table(const std::function<real(real, real)>& func,
		real _xmin, real _xmax, real _ymin, real _ymax, real toler,
		const char* filename) :
		xmin(_xmin), xmax(_xmax), ymin(_ymin), ymax(_ymax), NX(), NY(), C() {
	printf("%e %e %e %e\n", xmin, xmax, ymin, ymax);
	int nx = 8;
	int ny = 8;
	real err;
	biquintic_table table(func, xmin, xmax, ymin, ymax, nx, ny);
	err = table.Linf;
	do {
		biquintic_table test_x(func, xmin, xmax, ymin, ymax, 2 * nx, ny);
		biquintic_table test_y(func, xmin, xmax, ymin, ymax, nx, 2 * ny);
		if (test_x.L2 < test_y.L2) {
			nx *= 2;
			err = test_x.L2;
			*this = std::move(test_x);
		} else {
			ny *= 2;
			err = test_y.L2;
			*this = std::move(test_y);
		}
		printf(" %e %e %e %i %i\n", L1, L2, Linf, nx, ny);
	} while (err >= toler);
	if (filename) {
		FILE* fp = fopen(filename, "wt");
		for (real x = xmin + dx / 2.0; x < xmax; x += dx) {
			for (real y = ymin + dy / 2.0; y < ymax; y += dy) {
				fprintf(fp, "%e %e %e %e\n", x, y, (*this)(x, y), func(x, y));
			}
		}
		fclose(fp);
	}
}

biquintic_table::biquintic_table(const std::function<real(real, real)>& func,
		real _xmin, real _xmax, real _ymin, real _ymax, int _NX, int _NY) :
		xmin(_xmin), xmax(_xmax), ymin(_ymin), ymax(_ymax), NX(_NX), NY(_NY), C(
				_NX * _NY) {
	std::vector<real> data((NY + 1) * (NX + 1));
	real x, y;
	dx = (xmax - xmin) / real(NX);
	dy = (ymax - ymin) / real(NY);
	for (int iy = 0; iy <= NY; iy++) {
		y = ymin + iy * dy;
		for (int ix = 0; ix <= NX; ix++) {
			x = xmin + ix * dx;
			const real value = func(x, y);
			data[ix + iy * (NX + 1)] = value;
		}
	}
	for (int iy = 2; iy < NY - 2; iy++) {
		for (int ix = 2; ix < NX - 2; ix++) {
			int i2 = ix + iy * (NX);
			for (int j = 0; j < 36; j++) {
				int k = 0;
				C[i2][j] = 0.0;
				for (int kx = 0; kx < 6; kx++) {
					for (int ky = 0; ky < 6; ky++) {

						C[i2][j] +=
								W[j][k]
										* data[(ix - 2 + kx)
												+ (iy - 2 + ky) * (NX + 1)];
						k++;
					}
				}

			}
		}
	}
	L1 = L2 = 0.0;
	Linf = 0.0;
	int NS = NX * NY;
	for (int i = 0; i < NS; i++) {
		real x = xmin + rand1() * (xmax - xmin);
		real y = ymin + rand1() * (ymax - ymin);
		real exact = func(x, y);
		real interp = (*this)(x, y);
		real dif;
		dif = 0.5 * std::abs(exact - interp)
				/ (std::abs(exact) + std::abs(interp));
		dif = std::min(dif, std::abs(exact - interp));
		L1 += dif;
		L2 += dif * dif;
		Linf = std::max(Linf, dif);
	}
	L1 /= NS;
	L2 /= NS * NS;
	L2 = std::sqrt(L2);
	printf("%e %e %e\n", L1, L2, Linf);
}

bool biquintic_table::in_range(real x, real y) const {
	if (x < xmin || y < ymin || x >= xmax || y >= ymax) {
		return false;
	}
	return true;
}

constexpr real factorial[7] = { 1, 1, 2, 6, 24, 120, 720 };

real biquintic_table::operator()(real x, real y, int Dx, int Dy) const {
	int xi = std::min(std::max(2, int((x - xmin) / dx)), NX - 3);
	int yi = std::min(std::max(2, int((y - ymin) / dy)), NY - 3);
	if (x < xmin || y < ymin || x >= xmax || y >= ymax) {
		printf("Interpolation request out of range\n");
		printf("%e %e\n", x, y);
		abort();
	}
	x -= xmin + (xi + 0.5) * dx;
	y -= ymin + (yi + 0.5) * dy;
	x /= dx;
	y /= dy;
	const auto& c = C[xi + yi * NX];
	real y0, x0;
	real sum = 0.0;
	int k = 0;
	y0 = 1.0;
	for (int ky = Dy; ky < 6; ky++) {
		x0 = 1.0;
		const auto yfac = y0 * (factorial[ky] / factorial[ky - Dy]);
		for (int kx = Dx; kx < 6; kx++) {
			sum += yfac * c[k] * x0 * (factorial[kx] / factorial[kx - Dx]);
			x0 *= x;
			k++;
		}
		y0 *= y;
	}
	return sum;
}

